<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線上輔助唸珠 | 線上玫瑰經祈禱團體</title>
    
    <!-- 引入 Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- 引入 Font Awesome 圖示 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- 繼承全域變數 --- */
        :root {
            --primary-color: #003366; 
            --secondary-color: #4A90E2; 
            --accent-color: #D4AF37; 
            --bg-color: #F5F7FA;
            --section-bg: #FFFFFF;
            --border-color: #DAE1E7;
            --text-color: #2C3E50; 
            --light-text: #5D6D7E; 
            --white: #ffffff;
        }

        /* 菱形分隔線 */
        .totem-divider {
            height: 20px;
            width: 120px;
            margin: 20px auto 0;
            background-image: 
                linear-gradient(60deg, var(--secondary-color) 25%, transparent 25%, transparent 75%, var(--secondary-color) 75%, var(--secondary-color)), 
                linear-gradient(120deg, var(--secondary-color) 25%, transparent 25%, transparent 75%, var(--secondary-color) 75%, var(--secondary-color));
            background-position: 0 0, 0 0;
            background-size: 20px 30px;
            opacity: 0.8;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            color: var(--text-color);
            background-color: var(--bg-color);
            background-image: radial-gradient(#4A90E2 0.5px, transparent 0.5px), radial-gradient(#4A90E2 0.5px, #F5F7FA 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            background-attachment: fixed;
            line-height: 1.7;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            /* 禁止選取文字，讓點擊體驗更好 */
            user-select: none;
            -webkit-user-select: none;
        }

        h1, h2, h3, h4 {
            font-family: 'Noto Serif TC', serif;
            color: var(--primary-color);
            letter-spacing: 0.05em;
        }

        a { text-decoration: none; color: inherit; }

        /* --- 導覽列 --- */
        header {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 51, 102, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .header-top-bar {
            height: 6px;
            background: repeating-linear-gradient(
                90deg,
                var(--primary-color),
                var(--primary-color) 20px,
                var(--secondary-color) 20px,
                var(--secondary-color) 40px,
                var(--accent-color) 40px,
                var(--accent-color) 45px,
                var(--white) 45px,
                var(--white) 50px
            );
        }

        nav {
            max-width: 1100px;
            margin: 0 auto;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon-box {
            width: 44px;
            height: 44px;
            background-color: var(--primary-color);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50% 50% 0 50%;
            margin: 5px;
            box-shadow: 2px 2px 0px var(--accent-color);
        }

        .logo-icon-box i { font-size: 1.2rem; margin-top: 2px; color: var(--white); }
        .logo-text { display: flex; flex-direction: column; line-height: 1.2; }
        .logo small { font-size: 0.75rem; font-weight: 400; color: var(--secondary-color); }

        .nav-links { display: flex; gap: 2rem; align-items: center; }
        .nav-links a { font-weight: 600; transition: color 0.3s; color: var(--text-color); position: relative; }
        .nav-links a:hover { color: var(--secondary-color); }

        .cta-button-small {
            background-color: var(--secondary-color);
            color: var(--white) !important;
            padding: 0.6rem 1.4rem;
            font-size: 0.9rem;
            transition: all 0.3s;
            border-radius: 50px;
            box-shadow: 0 4px 6px rgba(74, 144, 226, 0.3);
        }
        .cta-button-small:hover { 
            background-color: var(--primary-color); 
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 51, 102, 0.3);
        }

        .mobile-menu-btn { display: none; font-size: 1.5rem; cursor: pointer; color: var(--primary-color); }

        /* --- 唸珠互動區 --- */
        #rosary-app {
            flex-grow: 1;
            padding-top: 100px; /* 避開 Header */
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
            padding-bottom: 2rem;
        }

        /* 奧蹟標題卡 */
        .mystery-header {
            background-color: var(--white);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-top: 4px solid var(--accent-color);
            margin-bottom: 2rem;
            width: 90%;
            text-align: center;
        }
        .mystery-header h2 { font-size: 1.4rem; margin-bottom: 5px; }
        .mystery-header p { color: var(--light-text); font-size: 0.9rem; }

        /* 珠子視覺化 (圓形排列) */
        .beads-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 1rem 0;
            /* 圓環軌道 */
            border: 2px dashed rgba(74, 144, 226, 0.2);
            border-radius: 50%;
        }

        /* 單顆珠子 */
        .bead {
            position: absolute;
            width: 24px;
            height: 24px;
            background-color: var(--white);
            border: 2px solid var(--secondary-color);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            /* 原住民風格：珠子像薏苡珠 */
            background-image: radial-gradient(circle at 30% 30%, white, #e0e7ff);
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }

        /* 目前激活的珠子 (發光) */
        .bead.active {
            width: 36px;
            height: 36px;
            background-color: var(--accent-color);
            border-color: var(--white);
            box-shadow: 0 0 15px var(--accent-color);
            z-index: 10;
        }
        
        /* 十字架 (中心裝飾) */
        .center-cross {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            color: rgba(0, 51, 102, 0.1);
        }

        /* 經文顯示區 */
        .prayer-display {
            background-color: var(--white);
            width: 90%;
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            margin-top: 1rem;
            border-bottom: 6px solid var(--primary-color);
            position: relative;
            cursor: pointer; /* 暗示可點擊 */
        }
        
        /* 點擊提示波紋 */
        .prayer-display:active {
            transform: scale(0.98);
            background-color: #f8fafc;
        }

        .prayer-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-family: 'Noto Serif TC', serif;
        }
        
        .prayer-text {
            font-size: 1.15rem;
            color: #444;
            line-height: 1.8;
            min-height: 120px; /* 避免文字長度跳動太大 */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .progress-indicator {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: var(--light-text);
            font-weight: 600;
            background: #eee;
            padding: 2px 10px;
            border-radius: 20px;
            display: inline-block;
        }

        /* 控制按鈕 */
        .controls {
            margin-top: 2rem;
            display: flex;
            gap: 20px;
        }

        .control-btn {
            background-color: var(--white);
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            width: 50px; height: 50px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background-color: var(--primary-color);
            color: var(--white);
        }
        
        /* 大顆的下一顆按鈕 (手機版好按) */
        .main-action-btn {
            background-color: var(--secondary-color);
            color: var(--white);
            border: none;
            padding: 1rem 3rem;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.4);
            cursor: pointer;
            display: none; /* 預設隱藏，主要靠點擊卡片，若需要可開啟 */
        }

        /* --- Footer --- */
        footer {
            background-color: var(--primary-color); color: var(--white); padding: 2rem 1.5rem; text-align: center;
            border-top: 8px solid var(--accent-color);
            margin-top: auto;
        }
        
        /* 點擊提示文字 */
        .tap-hint {
            position: absolute;
            bottom: 10px;
            width: 100%;
            text-align: center;
            font-size: 0.8rem;
            color: #999;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .nav-links { display: none; position: absolute; top: 100%; left: 0; width: 100%; background-color: var(--section-bg); flex-direction: column; padding: 1.5rem; box-shadow: 0 10px 15px rgba(0,0,0,0.1); border-bottom: 5px solid var(--secondary-color); }
            .nav-links.active { display: flex; }
            .nav-links a { margin: 10px 0; width: 100%; text-align: center; }
            .mobile-menu-btn { display: block; }
            
            .beads-container { width: 260px; height: 260px; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-top-bar"></div>
        <nav>
            <div class="logo">
                <div class="logo-icon-box"><i class="fa-solid fa-dove"></i></div>
                <div class="logo-text">
                    <span>線上玫瑰經祈禱</span>
                    <small>每晚9點 LINE會議室</small>
                </div>
            </div>
            <div class="nav-links">
                <a href="index.html">回到首頁</a>
                <a href="index.html#about">關於我們</a>
                <a href="index.html#info">聚會資訊</a>
                <a href="rosary.html" style="color: var(--secondary-color);"><i class="fa-solid fa-xs fa-bullseye"></i> 線上唸珠</a>
                <a href="intercession.html">代禱牆</a>
                <a href="https://line.me/R/meeting/6e1105b1919945ddad5390853d75be5d" target="_blank" class="cta-button-small">進入會議室</a>
            </div>
            <div class="mobile-menu-btn"><i class="fa-solid fa-bars"></i></div>
        </nav>
    </header>

    <div id="rosary-app">
        
        <!-- 奧蹟顯示 -->
        <div class="mystery-header">
            <h2 id="current-mystery-title">歡喜一端</h2>
            <p id="current-mystery-desc">天使向聖母瑪利亞報喜</p>
        </div>

        <!-- 珠子視覺化 -->
        <div class="beads-container" id="beads-ring">
            <div class="center-cross"><i class="fa-solid fa-cross"></i></div>
            <!-- 珠子由 JS 動態生成 -->
        </div>

        <!-- 經文卡片 (點擊區域) -->
        <div class="prayer-display" id="prayer-card" onclick="nextBead()">
            <div class="prayer-title" id="prayer-name">聖號經</div>
            <div class="prayer-text" id="prayer-content">因父、及子、及聖神之名。阿們。</div>
            <span class="progress-indicator" id="progress-text">開始</span>
            <div class="tap-hint"><i class="fa-solid fa-hand-pointer"></i> 點擊此處撥動下一顆唸珠</div>
        </div>

        <!-- 控制按鈕 -->
        <div class="controls">
            <button class="control-btn" onclick="resetRosary()" title="重新開始"><i class="fa-solid fa-rotate-left"></i></button>
            <button class="control-btn" onclick="prevBead()" title="上一顆"><i class="fa-solid fa-chevron-left"></i></button>
            <!-- 也可以放下一顆按鈕，但主要鼓勵點擊卡片 -->
        </div>

    </div>

    <footer>
        <p style="font-size: 1rem; opacity: 0.8;">線上輔助唸珠</p>
        <p style="font-size: 0.8rem; opacity: 0.6;">© 2025 Online Rosary Group.</p>
    </footer>

    <script>
        // --- 1. 定義經文內容 (Prayers Database) ---
        const prayers = {
            signOfCross: { title: "聖號經", content: "因父、及子、及聖神之名。阿們。" },
            creed: { title: "信經", content: "我信全能的天主父，天地萬物的創造者..." },
            ourFather: { title: "天主經", content: "我們的天父，願你的名受顯揚，願你的國來臨..." },
            hailMary: { title: "聖母經", content: "萬福瑪利亞，妳充滿聖寵，主與妳同在..." },
            gloryBe: { title: "聖三光榮經", content: "願光榮歸於父、及子、及聖神。起初如何，今日亦然，直到永遠。阿們。" },
            fatima: { title: "法蒂瑪聖母禱詞", content: "吾主耶穌，請寬赦我們的罪過，助我們免於地獄永火..." },
            hailHolyQueen: { title: "又聖母經", content: "萬福母后！仁慈的母親，我們的生命，我們的甘飴..." }
        };

        // --- 2. 定義奧蹟內容 (Mysteries Database) ---
        const mysteries = {
            joyful: [
                { title: "歡喜一端", desc: "天使向聖母瑪利亞報喜" },
                { title: "歡喜二端", desc: "聖母拜訪聖婦依撒伯爾" },
                { title: "歡喜三端", desc: "耶穌誕生於白冷" },
                { title: "歡喜四端", desc: "聖母獻耶穌於聖殿" },
                { title: "歡喜五端", desc: "耶穌十二歲講道" }
            ],
            luminous: [
                { title: "光明一端", desc: "耶穌在約旦河受洗" },
                { title: "光明二端", desc: "耶穌參加加納婚宴" },
                { title: "光明三端", desc: "耶穌宣講天國福音" },
                { title: "光明四端", desc: "耶穌顯聖容" },
                { title: "光明五端", desc: "耶穌建立聖體聖事" }
            ],
            sorrowful: [
                { title: "痛苦一端", desc: "耶穌山園祈禱" },
                { title: "痛苦二端", desc: "耶穌受鞭打之刑" },
                { title: "痛苦三端", desc: "耶穌受茨冠之苦刑" },
                { title: "痛苦四端", desc: "耶穌背十字架上山" },
                { title: "痛苦五端", desc: "耶穌被釘死在十字架上" }
            ],
            glorious: [
                { title: "榮福一端", desc: "耶穌復活" },
                { title: "榮福二端", desc: "耶穌升天" },
                { title: "榮福三端", desc: "聖神降臨" },
                { title: "榮福四端", desc: "聖母蒙召升天" },
                { title: "榮福五端", desc: "天主光榮聖母" }
            ]
        };

        // --- 3. 唸珠流程邏輯 (Sequence Logic) ---
        // 為了簡化，這裡演示「一端」的標準流程 + 前導經文 (可擴充為五端)
        // 序列結構：[ {type: 'prayerKey', label: '顯示進度', mysteryIndex: 0} ]
        
        let rosarySequence = [];
        let currentIndex = 0;
        let todayMysteries = [];

        // 初始化：根據星期幾決定奧蹟
        function initMystery() {
            const day = new Date().getDay();
            // 規則：一六歡喜，二五痛苦，三日榮福，四光明
            if (day === 1 || day === 6) todayMysteries = mysteries.joyful;
            else if (day === 2 || day === 5) todayMysteries = mysteries.sorrowful;
            else if (day === 4) todayMysteries = mysteries.luminous;
            else todayMysteries = mysteries.glorious; // 週三、週日
        }

        // 建立唸珠序列 (5端完整版太長，這裡演示「1端」的精華版，或做個開關)
        // 為了體驗，我們先做「第1端」的完整流程
        function buildSequence() {
            rosarySequence = [];
            
            // 1. 開始：聖號經
            rosarySequence.push({ key: 'signOfCross', step: '開始', beadType: 'cross' });
            
            // 2. 信經 (通常在大珠)
            rosarySequence.push({ key: 'creed', step: '信經', beadType: 'large' });
            
            // 3. 天主經 (為教宗)
            rosarySequence.push({ key: 'ourFather', step: '為教宗祈禱', beadType: 'large' });
            
            // 4. 聖母經 x3 (信望愛)
            for(let i=1; i<=3; i++) {
                rosarySequence.push({ key: 'hailMary', step: `信望愛 ${i}/3`, beadType: 'small' });
            }
            
            // 5. 聖三光榮經
            rosarySequence.push({ key: 'gloryBe', step: '光榮經', beadType: 'gap' });

            // --- 第一端開始 ---
            // 6. 宣讀奧蹟
            rosarySequence.push({ 
                key: 'mystery', 
                mysteryIdx: 0, // 第一端
                step: '第一端奧蹟', 
                beadType: 'large' 
            });
            
            // 7. 天主經
            rosarySequence.push({ key: 'ourFather', step: '第一端', beadType: 'large' });

            // 8. 聖母經 x10
            for(let i=1; i<=10; i++) {
                rosarySequence.push({ key: 'hailMary', step: `聖母經 ${i}/10`, beadType: 'small', isDecade: true, decadeIndex: i });
            }

            // 9. 聖三光榮經
            rosarySequence.push({ key: 'gloryBe', step: '第一端結束', beadType: 'gap' });
            
            // 10. 法蒂瑪聖母禱詞
            rosarySequence.push({ key: 'fatima', step: '法蒂瑪禱詞', beadType: 'gap' });

            // (若要完整5端，需重複步驟 6-10 四次，這裡為演示僅做一端)
            
            // 11. 結束：又聖母經
            rosarySequence.push({ key: 'hailHolyQueen', step: '結束禱詞', beadType: 'large' });
            
            // 12. 聖號經
            rosarySequence.push({ key: 'signOfCross', step: '禮成', beadType: 'cross' });
        }

        // --- 4. 渲染珠子 (Visual Rendering) ---
        function renderBeads() {
            const container = document.getElementById('beads-ring');
            container.innerHTML = '<div class="center-cross"><i class="fa-solid fa-cross"></i></div>'; // 清空但保留十字架
            
            // 我們只渲染那 10 顆聖母經的珠子作為視覺主體
            // 或者渲染一個圓環代表這一端
            const totalBeads = 10;
            const radius = 135; // 半徑
            
            for (let i = 0; i < totalBeads; i++) {
                const bead = document.createElement('div');
                bead.className = 'bead';
                bead.id = `bead-${i+1}`;
                
                // 計算圓周位置 (從上方開始 -90度)
                const angle = (i / totalBeads) * 360 - 90; 
                const x = radius * Math.cos(angle * Math.PI / 180);
                const y = radius * Math.sin(angle * Math.PI / 180);
                
                bead.style.left = `calc(50% + ${x}px)`;
                bead.style.top = `calc(50% + ${y}px)`;
                
                container.appendChild(bead);
            }
        }

        // --- 5. 互動控制 (Interaction) ---
        function updateDisplay() {
            const currentStep = rosarySequence[currentIndex];
            const titleEl = document.getElementById('prayer-name');
            const contentEl = document.getElementById('prayer-content');
            const progressEl = document.getElementById('progress-text');
            const mysteryTitle = document.getElementById('current-mystery-title');
            const mysteryDesc = document.getElementById('current-mystery-desc');
            
            // 更新奧蹟標題 (如果是奧蹟步驟，或保持當前奧蹟)
            // 這裡簡化：始終顯示第一端，若有多端需動態更新
            const currentM = todayMysteries[0]; 
            mysteryTitle.innerText = currentM.title;
            mysteryDesc.innerText = currentM.desc;

            // 更新經文
            if (currentStep.key === 'mystery') {
                titleEl.innerText = currentM.title;
                contentEl.innerText = currentM.desc + "\n(請默想此奧蹟)";
            } else {
                titleEl.innerText = prayers[currentStep.key].title;
                contentEl.innerText = prayers[currentStep.key].content;
            }
            
            progressEl.innerText = currentStep.step;

            // 更新珠子視覺 (Highlight)
            // 先重置所有珠子
            document.querySelectorAll('.bead').forEach(b => b.classList.remove('active'));
            
            // 如果是 10 遍聖母經的環節，點亮對應珠子
            if (currentStep.isDecade) {
                const bead = document.getElementById(`bead-${currentStep.decadeIndex}`);
                if(bead) bead.classList.add('active');
            } else {
                // 非十遍經時，可以讓十字架或其他元素發光，這裡暫時不處理
            }
        }

        function nextBead() {
            if (currentIndex < rosarySequence.length - 1) {
                currentIndex++;
                updateDisplay();
                // 震動回饋 (僅手機有效)
                if (navigator.vibrate) navigator.vibrate(10); 
            } else {
                alert("祈禱結束，感謝天主！");
                currentIndex = 0;
                updateDisplay();
            }
        }

        function prevBead() {
            if (currentIndex > 0) {
                currentIndex--;
                updateDisplay();
            }
        }

        function resetRosary() {
            if(confirm("確定要重新開始嗎？")) {
                currentIndex = 0;
                updateDisplay();
            }
        }

        // --- 初始化 ---
        window.onload = function() {
            initMystery();
            buildSequence();
            renderBeads();
            updateDisplay();
            
            // 手機選單開關 (複製自 index.html)
            const mobileBtn = document.querySelector('.mobile-menu-btn');
            const navLinks = document.querySelector('.nav-links');
            if(mobileBtn) {
                mobileBtn.addEventListener('click', () => { navLinks.classList.toggle('active'); });
            }
        };

    </script>
</body>
</html>
